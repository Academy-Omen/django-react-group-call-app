(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{251:function(e,t){},253:function(e,t){},261:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(11),s=r.n(o),i=r(17),c=r(12),l=r(19),d=r(21),u=(r(200),r(25)),m=r(110),b=r(13),p=r(96),h=r.n(p),j=r(72),f=r(15),g=r(137),O=r(3),v=window.location.origin+"/api/",x="/",k="/login",y="/register",R="/video/:roomId",w="UB CLASSROOM",F="Login",S="Register",_="Logout",N=r(2),C=["component","authenticationProps"];var I=function(e){var t=e.component,r=e.authenticationProps,a=Object(O.a)(e,C);return Object(N.jsx)(f.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return r.isUserLoggedIn?Object(N.jsx)(f.a,{to:x,exact:!0}):Object(N.jsx)(t,Object(u.a)(Object(u.a)({redirectPath:x},e),r))}}))},T=r(31),A=r(267),E=r(269),M=r(262),B=r(268),D=r(5),L=r(324),U=r(322);var P=function(e){var t=e.severity,r=e.feedbackMsg,a=e.isFeedbackOpen,n=e.closeFeedback;return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(L.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:a,autoHideDuration:6e3,onClose:n,children:Object(N.jsx)(U.a,{onClose:n,severity:t,children:r})})})},V=r(311),z=["name","label","type","MUComponent"];var W=function(e){var t=e.name,r=e.label,a=e.type,n=void 0===a?"text":a,o=e.MUComponent,s=void 0===o?V.a:o,i=Object(O.a)(e,z);return Object(N.jsx)("div",{children:Object(N.jsx)(T.b,Object(u.a)(Object(u.a)({name:t,label:r,type:n},i),{},{helperText:Object(N.jsx)(T.a,{name:t}),as:s}))})},q=r(326),H=r(266),Y=r(270),J=r(272);function G(e){var t=e.label,r=e.children,a=e.value,n=e.name,o=e.errorString,s=e.onChange,i=e.onBlur;return Object(N.jsxs)(H.a,{fullWidth:!0,children:[Object(N.jsx)(J.a,{children:t}),Object(N.jsx)(Y.a,{value:a,name:n,onChange:s,onBlur:i,children:r}),Object(N.jsx)(A.a,{children:o})]})}var X=function(e){var t=e.name,r=e.label,a=e.items,n=void 0===a?[]:a;return Object(N.jsx)(T.b,{name:t,label:r,errorString:Object(N.jsx)(T.a,{name:t}),as:G,children:n.map((function(e){return Object(N.jsx)(q.a,{value:e.value,children:e.label},e.value)}))})},K=r(314),Q=r(313);var Z=function(){return Object(N.jsx)(Q.a,{style:{textAlign:"center"},children:Object(N.jsx)(K.a,{})})},$=r(315);var ee=function(e){var t=e.innerText,r=e.linkTo;return Object(N.jsx)($.a,{component:j.b,to:r,children:t})},te=n.a.createContext({isDataArrived:!1,userId:null,userFullName:"",isUserLoggedIn:!1});var re=function(e){return Object(N.jsx)(te.Provider,{value:e.userData,children:e.children})},ae=r(170),ne=r.n(ae);var oe=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var r=document.cookie.split(";"),a=0;a<r.length;a++){var n=r[a].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}("csrftoken"),se=ne.a.create({baseURL:v,timeout:5e3,headers:{"Content-Type":"application/json",accept:"application/json","X-CSRFToken":oe,Authorization:"Bearer "+localStorage.getItem("access_token")}}),ie=se,ce=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return delete e.defaults.headers.Authorization,""!==t?e.get("rooms/?search=".concat(t)):e.get("rooms/")},le=function(e,t){return e.post("token/verify/",{token:t})},de=function(){var e=localStorage.getItem("access_token");le(se,e).then((function(t){200===t.status&&(se.defaults.headers.Authorization="Bearer "+e)})).catch((function(e){var t=localStorage.getItem("refresh_token");400!==e.response.status&&401!==e.response.status||!t||se.post("token/refresh/",{refresh:t}).then((function(e){var t=e.status,r=e.data;200===t&&(localStorage.setItem("access_token",r.access),se.defaults.headers.Authorization="Bearer "+r.access)})).catch((function(e){console.log(e.message)}))}))},ue=r(29),me=ue.a().shape({email:ue.c().email().required(),password:ue.c().required()}),be=ue.a().shape({email:ue.c().email().required(),firstName:ue.c().required().label("First Name"),lastName:ue.c().required().label("Last Name"),password:ue.c().min(8).required(),confirmation:ue.c().oneOf([ue.b("password"),null],"Passwords must match").required()}),pe=ue.a().shape({title:ue.c().required(),description:ue.c(),typeOf:ue.c().required().oneOf(["OTA","IO"])}),he=r(8),je=function(e){return{formPaper:Object(he.a)({margin:"2rem auto",width:"80%",padding:e.spacing(3),textAlign:"center",borderRadius:"1rem"},e.breakpoints.up("md"),{margin:"4rem auto",width:"40%"}),fullName:Object(he.a)({display:"flex","flex-direction":"column","justify-content":"space-between"},e.breakpoints.up("md"),{"flex-direction":"row","justify-content":"space-evenly"}),formButton:{margin:"1.5rem 0",color:"#fff","background-image":"#114B5F",transition:"0.5s","background-size":" 200% auto","&:hover":{"background-position":"right center"},"&:disabled":{background:"#456990",color:"#E4FDE1"}}}},fe=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).state={serverErrors:""},a.onSubmitLoginForm=a.onSubmitLoginForm.bind(Object(b.a)(a)),a}return Object(c.a)(r,[{key:"onSubmitLoginForm",value:function(e){var t=this,r={email:e.email,password:e.password},a=this.props,n=a.history,o=a.redirectPath,s=a.authenticateUser,i=a.printFeedback;ie.post("token/",r).then((function(e){var t=e.data;ie.defaults.headers.Authorization="Bearer "+t.access,localStorage.setItem("access_token",t.access),localStorage.setItem("refresh_token",t.refresh),s(),n.push(o),i({type:"success",feedbackMsg:"You are logged in"})})).catch((function(e){console.log(e.message),e.response&&t.setState({serverErrors:Object.values(e.response.data)})}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return Object(N.jsx)(M.a,{className:t.formPaper,elevation:3,children:Object(N.jsx)(T.d,{initialValues:{email:"",password:""},onSubmit:this.onSubmitLoginForm,validationSchema:me,children:function(r){var a=r.dirty,n=r.isValid,o=r.errors,s=r.touched;return Object(N.jsxs)(T.c,{children:[Object(N.jsx)(B.a,{align:"center",variant:"h3",children:"Login"}),Object(N.jsx)(W,{name:"email",label:"Email",type:"email",fullWidth:!0,required:!0,error:o.email&&s.email}),Object(N.jsx)(W,{name:"password",label:"Password",type:"password",fullWidth:!0,required:!0,error:o.password&&s.password}),e.state.serverErrors?e.state.serverErrors.map((function(e,t){return Object(N.jsx)(A.a,{error:!0,children:e},t)})):null,Object(N.jsx)(E.a,{fullWidth:!0,className:t.formButton,type:"submit",variant:"contained",color:"primary",disabled:!a||!n,children:"Login"}),Object(N.jsxs)(B.a,{display:"block",variant:"caption",children:["not a member?",Object(N.jsx)(ee,{linkTo:"/register",innerText:"Register"})]})]})}})})}}]),r}(a.Component),ge=Object(D.a)(je)(fe),Oe=["Your password can\u2019t be too similar to your other personal information.","Your password must contain at least 8 characters.","Your password can\u2019t be a commonly used password. ","Your password can\u2019t be entirely numeric."],ve=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).state={serverErrors:""},a.onSubmitRegisterForm=a.onSubmitRegisterForm.bind(Object(b.a)(a)),a}return Object(c.a)(r,[{key:"onSubmitRegisterForm",value:function(e){var t=this,r={email:e.email,firstName:e.firstName,lastName:e.lastName,password:e.password},a=this.props,n=a.history,o=a.redirectPath,s=a.authenticateUser,i=a.printFeedback;ie.post("user/create/",r).then((function(e){var t=e.data.tokens;ie.defaults.headers.Authorization="Bearer "+t.access,localStorage.setItem("access_token",t.access),localStorage.setItem("refresh_token",t.refresh),s(),n.push(o),i({type:"success",feedbackMsg:"You are registered and logged in"})})).catch((function(e){console.log(e.message),e.response&&t.setState({serverErrors:Object.values(e.response.data)})}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return Object(N.jsx)(M.a,{className:t.formPaper,elevation:3,children:Object(N.jsx)(T.d,{initialValues:{firstName:"",lastName:"",email:"",password:"",confirmation:""},onSubmit:this.onSubmitRegisterForm,validationSchema:be,children:function(r){var a=r.dirty,n=r.isValid,o=r.errors,s=r.touched;return Object(N.jsxs)(T.c,{children:[Object(N.jsx)(B.a,{align:"center",variant:"h3",children:"Register"}),Object(N.jsxs)("div",{className:t.fullName,children:[Object(N.jsx)(W,{fullWidth:!0,name:"firstName",label:"First Name",type:"text",required:!0,error:o.firstName&&s.firstName}),Object(N.jsx)(W,{fullWidth:!0,name:"lastName",label:"Last Name",type:"text",required:!0,error:o.lastName&&s.lastName})]}),Object(N.jsx)(W,{name:"email",label:"Email",type:"email",fullWidth:!0,required:!0,error:o.email&&s.email}),Object(N.jsx)(W,{name:"password",label:"Password",type:"password",fullWidth:!0,required:!0,error:o.password&&s.password}),Oe.map((function(e,t){return Object(N.jsx)(A.a,{children:e},t)})),Object(N.jsx)(W,{name:"confirmation",label:"Confirm Password",type:"password",fullWidth:!0,required:!0,error:o.confirmation&&s.confirmation}),Object(N.jsx)(A.a,{children:"Enter the same password as before, for verification."}),e.state.serverErrors?e.state.serverErrors.map((function(e,t){return Object(N.jsx)(A.a,{error:!0,children:e},t)})):null,Object(N.jsx)(E.a,{fullWidth:!0,className:t.formButton,type:"submit",variant:"contained",color:"primary",disabled:!a||!n,children:"Register"}),Object(N.jsxs)(B.a,{display:"block",variant:"caption",children:["already have an account?",Object(N.jsx)(ee,{linkTo:"/login",innerText:"Log In"})]})]})}})})}}]),r}(a.Component),xe=Object(D.a)(je)(ve),ke=r(323),ye=r(318),Re=r(325),we=r(316),Fe=r(317),Se=r(172),_e=r.n(Se),Ne=function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},gridContainer:Object(he.a)({width:"100%",display:"grid","grid-template-columns":"repeat(1, 1fr)","grid-template-rows":"auto",gap:"1rem","justify-content":"center","grid-template-areas":'\n    "description"\n    "buttons"\n    "copy_btn";'},e.breakpoints.up("md"),{"grid-template-columns":"3fr, 1fr","grid-template-areas":'\n    "description buttons"\n    "copy_btn copy_btn"'}),gridItemA:{width:"100%","grid-area":"description"},gridItemB:{width:"100%","grid-area":"buttons"},gridItemC:{"grid-area":"copy_btn"},enterBtn:{"background-image":"#114B5F",transition:"0.5s","background-size":" 200% auto","&:hover":{"background-position":"right center"}}}},Ce=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).copyRoomUrl=function(e){document.getElementById("room-data-base".concat(e)).select(),document.execCommand("copy"),a.props.printFeedback({type:"success",feedbackMsg:"Link copied"})},a.renderRoomType=a.renderRoomType.bind(Object(b.a)(a)),a}return Object(c.a)(r,[{key:"renderRoomType",value:function(e){switch(e){case"OTA":return"Open to All";case"IO":return"Invite only";default:return"unrecognized room type"}}},{key:"render",value:function(){var e=this,t=this.props,r=t.apiData,a=r.id,n=r.title,o=r.description,s=r.typeOf,i=r.createdOn,c=r.roomId,l=r.user,d=t.classes,u=t.deleteRoom,m=t.enterRoom,b=this.context.userId;return Object(N.jsxs)(Re.a,{children:[Object(N.jsxs)(we.a,{expandIcon:Object(N.jsx)(_e.a,{}),children:[Object(N.jsx)(B.a,{className:d.heading,children:n}),Object(N.jsx)(B.a,{className:d.secondaryHeading,children:this.renderRoomType(s)})]}),Object(N.jsx)(Fe.a,{children:Object(N.jsxs)("div",{className:d.gridContainer,children:[Object(N.jsxs)("div",{className:d.gridItemA,children:[Object(N.jsx)(B.a,{style:{fontWeight:"bolder"},gutterBottom:!0,variant:"h5",children:n}),Object(N.jsxs)(B.a,{variant:"caption",style:{color:"gray"},children:["created on ",i]}),Object(N.jsx)(B.a,{variant:"body1",children:o})]}),Object(N.jsx)("div",{className:d.gridItemB,children:Object(N.jsxs)(ye.a,{fullWidth:!0,size:"small",orientation:"vertical",variant:"contained",children:[b===l?Object(N.jsx)(E.a,{style:{transition:"0.5s"},color:"secondary",onClick:function(){return u(a)},children:"Delete Room"}):null,"IO"!==s||b===l?Object(N.jsx)(E.a,{className:d.enterBtn,onClick:function(){return m(c)},color:"primary",children:"Enter Room"}):null]})}),Object(N.jsx)("div",{className:d.gridItemC,children:b===l&&"IO"===s?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(V.a,{variant:"outlined",fullWidth:!0,size:"small",id:"room-data-base".concat(a),defaultValue:window.location.origin+"/video/".concat(c)}),Object(N.jsx)(E.a,{style:{transition:"0.5s"},fullWidth:!0,color:"secondary",size:"small",onClick:function(){return e.copyRoomUrl(a)},children:"Copy room link"})]}):null})]})})]})}}]),r}(a.Component);Ce.contextType=te;var Ie=Object(D.a)(Ne)(Ce),Te=function(e){return{formPaper:Object(he.a)({padding:"2rem",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%"},e.breakpoints.up("md"),{width:"40%"}),createRoomBtn:{margin:"1rem 0",background:"#114B5F",transition:"0.5s","background-size":" 200% auto","&:hover":{"background-position":"right center",background:"#114B5F"},"&:disabled":{background:"#114B5F",color:"#E4FDE1"}}}},Ae=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).roomTypes=[{value:"OTA",label:"Open to all"},{value:"IO",label:"Invite only"}],a}return Object(c.a)(r,[{key:"render",value:function(){var e=this,t={user:this.context.userId,title:"",description:"",typeOf:"OTA"},r=this.props,a=r.classes,n=r.onRoomFormSubmit;return Object(N.jsx)(M.a,{className:a.formPaper,elevation:3,children:Object(N.jsx)(T.d,{initialValues:t,onSubmit:n,validationSchema:pe,children:function(t){var r=t.isValid,n=t.dirty,o=t.errors,s=t.touched;return Object(N.jsxs)(T.c,{children:[Object(N.jsx)(B.a,{align:"center",variant:"h4",children:"New Room"}),Object(N.jsx)(W,{name:"title",label:"Title",type:"text",required:!0,fullWidth:!0,error:o.title}),Object(N.jsx)(W,{name:"description",label:"Event description",type:"text",fullWidth:!0,error:o.description,multiline:!0,rows:4}),Object(N.jsx)(X,{name:"typeOf",label:"Room type",items:e.roomTypes,error:o.typeOf||s.typeOf,required:!0}),Object(N.jsx)(E.a,{fullWidth:!0,disabled:!n||!r,className:a.createRoomBtn,variant:"contained",type:"submit",children:"Create Room"})]})}})})}}]),r}(a.Component);Ae.contextType=te;var Ee=Object(D.a)(Te)(Ae),Me=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).onRoomFormSubmit=function(){var e=Object(m.a)(h.a.mark((function e(t,r){var n,o,s,i,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.resetForm,o={user:t.user,title:t.title,description:t.description,typeOf:t.typeOf},s=a.props,i=s.printFeedback,c=s.closeRoomForm,e.next=5,de();case 5:return e.next=7,ie.post("rooms/",o).then((function(){n(),c(),i({type:"success",feedbackMsg:"Room created"}),a.props.loadRooms()})).catch((function(e){if(e.response){var t=e.response.status;401!==t&&400!==t||(c(),i({type:"error",feedbackMsg:"You are not logged in."}))}console.log(e.message)}));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),a.deleteRoom=function(e){var t=a.props.printFeedback;ie.delete("rooms/"+e).then((function(e){a.props.loadRooms(),t({type:"success",feedbackMsg:"Room deleted"})})).catch((function(e){return console.log(e.message)}))},a.enterRoom=function(e){a.props.history.push("/video/".concat(e))},a.render=function(){var e=a.props,t=e.closeRoomForm,r=e.isRoomFormOpen,o=e.roomListData,s=e.loadingRooms,i=e.printFeedback,c=a.context,l=c.isUserLoggedIn,d=c.isDataArrived;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(ke.a,{disableAutoFocus:!0,open:r,onClose:t,children:Object(N.jsx)(Ee,{onRoomFormSubmit:a.onRoomFormSubmit})}),!l&&d?Object(N.jsx)("div",{style:{textAlign:"center",margin:"1rem 0"},children:Object(N.jsxs)(B.a,{children:[" Please ",Object(N.jsx)(ee,{linkTo:"/login",innerText:"Login"})," Or ",Object(N.jsx)(ee,{linkTo:"/register",innerText:"Register"})," to create or enter room"]})}):null,Object(N.jsx)("div",{style:{marginTop:"1rem"},children:s?Object(N.jsx)(Z,{}):o.length>0?o.map((function(e){return Object(N.jsx)(n.a.Fragment,{children:Object(N.jsx)(Ie,{deleteRoom:a.deleteRoom,enterRoom:a.enterRoom,apiData:e,printFeedback:i})},e.id)})):Object(N.jsx)(U.a,{severity:"info",children:"No Rooms Yet!!"})})]})},a.deleteRoom=a.deleteRoom.bind(Object(b.a)(a)),a.enterRoom=a.enterRoom.bind(Object(b.a)(a)),a.onRoomFormSubmit=a.onRoomFormSubmit.bind(Object(b.a)(a)),a}return Object(c.a)(r,[{key:"componentDidMount",value:function(){this.props.loadRooms()}}]),r}(a.Component);Me.contextType=te;var Be=Me,De=["lobbyProps"];var Le=function(e){var t=e.lobbyProps,r=Object(O.a)(e,De);return Object(N.jsx)(f.b,Object(u.a)(Object(u.a)({},r),{},{render:function(e){return Object(N.jsx)(Be,Object(u.a)(Object(u.a)({},t),e))}}))},Ue=r(319),Pe=r(320),Ve=r(263),ze=r(176),We=r.n(ze),qe=r(182),He=r(183),Ye=r(173),Je=r.n(Ye),Ge=r(175),Xe=r.n(Ge),Ke=r(327),Qe=r(139),Ze=function(e){return{root:{flexGrow:1},appBar:{background:"#114B5F"},pageTitle:{marginRight:e.spacing(2)},search:Object(he.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(Qe.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(Qe.fade)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(he.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"}),menuButton:{marginRight:e.spacing(2)},username:Object(he.a)({marginRight:e.spacing(2),marginLeft:e.spacing(1),display:"none"},e.breakpoints.up("sm"),{display:"block"})}},$e=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).changePageTitle=function(){var e,t=a.props.location.pathname,r=w,n=F,o=S;switch(t){case x:e=r;break;case k:e=n;break;case y:e=o;break;default:e="404"}return t.match("/video/")&&(e="Room"),a.setState({pageTitle:e}),e},a.handleMenuOpen=function(e){a.setState({anchorEl:e.currentTarget})},a.menuAction=function(e){var t=a.props,r=t.history,n=t.authenticateUser,o=t.printFeedback,s=e.currentTarget.dataset.menu,i=x,c=k,l=y;if(s&&r)switch(s){case w:r.push(i);break;case F:r.push(c);break;case S:r.push(l);break;case _:localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),n(),o({type:"success",feedbackMsg:"Logged out successfully"}),r.push(i)}a.setState({anchorEl:null})},a.showComponents=function(){a.changePageTitle(),"/"!==a.props.location.pathname?a.setState({isComponentShown:!1}):a.setState({isComponentShown:!0})},a.componentDidMount=function(){a.showComponents()},a.state={anchorEl:null,pageTitle:a.changePageTitle(),isComponentShown:!1},a}return Object(c.a)(r,[{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&(this.showComponents(),this.changePageTitle())}},{key:"render",value:function(){var e=this,t=this.props,r=t.classes,a=t.openRoomForm,n=t.search,o=t.handleSearchChanges,s=this.state,i=s.anchorEl,c=s.pageTitle,l=s.isComponentShown,d=this.context,u=d.userFullName,m=d.isUserLoggedIn,b=m?[w,_]:[w,F,S];return Object(N.jsx)("div",{className:r.root,children:Object(N.jsx)(Ue.a,{className:r.appBar,position:"static",children:Object(N.jsxs)(Pe.a,{children:[Object(N.jsx)(B.a,{className:r.pageTitle,variant:"h6",children:c}),l?Object(N.jsxs)("div",{className:r.search,children:[Object(N.jsx)("div",{className:r.searchIcon,children:Object(N.jsx)(Je.a,{})}),Object(N.jsx)(He.a,{value:n,onChange:o,placeholder:"Search room title\u2026",classes:{root:r.inputRoot,input:r.inputInput}})]}):null,Object(N.jsx)("div",{className:r.root}),l?Object(N.jsx)(Ke.a,{title:"Create Room",children:Object(N.jsx)(Ve.a,{onClick:a,color:"inherit",children:Object(N.jsx)(Xe.a,{})})}):null,Object(N.jsx)(B.a,{className:r.username,variant:"subtitle1",children:u&&""!==u?u:"Anonymous"}),Object(N.jsx)(Ke.a,{title:"Menu",children:Object(N.jsx)(Ve.a,{onClick:this.handleMenuOpen,edge:"start",color:"inherit",children:Object(N.jsx)(We.a,{})})}),Object(N.jsx)(qe.a,{anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,open:Boolean(i),onClose:this.menuAction,children:b.map((function(t,r){return Object(N.jsx)(q.a,{"data-menu":t,onClick:e.menuAction,children:t},r)}))})]})})})}}]),r}(a.Component);$e.contextType=te;var et=Object(f.g)(Object(D.a)(Ze)($e)),tt=r(46),rt=r(140),at=r.n(rt),nt=r(321),ot=r(180),st=r.n(ot),it=r(179),ct=r.n(it),lt=r(178),dt=r.n(lt),ut=r(177),mt=r.n(ut),bt=r(181),pt=r.n(bt),ht=function(e){return{floatingButtons:{zIndex:1,position:"fixed",bottom:0,left:"50%",transform:"translate(-50%, -50%)"},floatingButton:{margin:"0 0.5rem"},videoGrid:Object(he.a)({marginTop:"1rem",marginBottom:"15rem",width:"100%",display:"grid","grid-template-columns":"repeat(2, 1fr)","grid-template-rows":"auto",gap:"0.3rem"},e.breakpoints.up("md"),{marginBottom:"20rem","grid-template-columns":"repeat(4, 1fr)"}),remoteVideoDiv:{overflow:"hidden",borderRadius:"0.5rem",background:"gray",position:"relative"},localVideoDiv:Object(he.a)({zIndex:2,borderRadius:"0.5rem",position:"fixed",bottom:40,left:"50%",transform:"translate(-50%, -50%)",width:"150px",height:"100px",background:"black"},e.breakpoints.up("md"),{bottom:30,width:"200px",height:"150px"}),video:{borderRadius:"0.5rem",objectFit:"cover",width:"100%",height:"100%"},userDetail:{textAlign:"center",width:"100%",borderRadius:"0.5rem",transition:"0.3s",position:"absolute",background:"#E4FDE1",padding:"0.3rem 1rem",bottom:-20,left:"50%",transform:"translate(-50%, -50%)"},alert:{marginTop:"1rem"}}},jt=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).mouseHoverIn=function(){a.setState({isMouseHovering:!0})},a.mouseHoverOut=function(){a.setState({isMouseHovering:!1})},a.componentDidMount=function(){var e=a.props,t=e.peer,r=e.user_id;t&&r&&t.on("stream",(function(e){document.getElementById("remote-".concat(r)).srcObject=e}))},a.state={isMouseHovering:!1},a}return Object(c.a)(r,[{key:"render",value:function(){var e,t,r=this.props,a=r.user_full_name,n=r.id,o=r.classes,s=r.isLocalUser;return s?e=o.localVideoDiv:(e=o.remoteVideoDiv,t=this.state.isMouseHovering?{opacity:1}:{opacity:0}),Object(N.jsxs)("div",{onMouseOver:this.mouseHoverIn,onMouseOut:this.mouseHoverOut,className:e,children:[Object(N.jsx)("video",{className:o.video,id:n,autoPlay:!0,muted:s}),s?null:Object(N.jsx)("div",{style:t,className:o.userDetail,children:Object(N.jsx)(B.a,{variant:"overline",children:a||"Anonymous"})})]})}}]),r}(a.Component),ft=Object(D.a)(ht)(jt),gt=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).muteVideo=function(){var e=document.getElementById("localVideo").srcObject;e.getVideoTracks()[0]&&(e.getVideoTracks()[0].enabled=!e.getVideoTracks()[0].enabled,a.setState({isVideoMuted:!e.getVideoTracks()[0].enabled}))},a.muteAudio=function(){var e=document.getElementById("localVideo").srcObject;e.getAudioTracks()[0]&&(e.getAudioTracks()[0].enabled=!e.getAudioTracks()[0].enabled,a.setState({isAudioMuted:!e.getAudioTracks()[0].enabled}))},a.leaveRoom=function(){a.props.history.push(x)},a.CreatePeer=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=new at.a({initiator:!0,trickle:!1,stream:r});return n.on("signal",(function(r){a.state.websocket.send(JSON.stringify({type:"sending_offer",from:e,to:t,offer:r}))})),n},a.addPeer=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=new at.a({initiator:!1,trickle:!1,stream:n});return o.signal(r),o.on("signal",(function(r){a.state.websocket.send(JSON.stringify({type:"sending_answer",from:e,to:t,answer:r}))})),o},a.sendSignalsToAll=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];a.state.usersConnected.forEach((function(n){if(n.user_id!==e){var o=a.CreatePeer(e,n.user_id,t);r.push({user_id:n.user_id,user_full_name:n.user_full_name,peer:o})}})),a.setState({peersEstablished:r})},a.componentDidMount=function(){var e=a.props,t=e.printFeedback,r=e.match.params;if(!navigator.mediaDevices)return a.setState({isVideoRoomAccessible:!1}),void t({type:"error",feedbackMsg:"this video room is not accessible because the site is not running on secure protocol, i.e. 'HTTPS'"});var n=a.context,o=n.userId,s=n.userFullName,i=new WebSocket(("https:"===window.location.protocol?"wss://":"ws://")+window.location.host+"/video/"+"".concat(r.roomId,"/"));a.setState({websocket:i}),i.onopen=function(){a.setState({contentLoading:!0}),i.send(JSON.stringify({type:"new_user_joined",from:o,user_full_name:s,token:localStorage.getItem("access_token")}))},i.onmessage=function(e){var r=JSON.parse(e.data);switch(r.type){case"new_user_joined":if(a.setState({usersConnected:r.users_connected}),o===r.from&&navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){a.setState({stream:e}),document.getElementById("localVideo").srcObject=e,a.sendSignalsToAll(o,e)})).catch((function(e){a.setState({isVideoRoomAccessible:!1}),t({type:"error",feedbackMsg:"you need to enable media devices inorder to use access this room"}),console.log(e.message)})),o!==r.from){var n=a.state.usersConnected.find((function(e){return e.user_id===r.from}));t({type:"success",feedbackMsg:"".concat(n.user_full_name," joined this room")}),console.log("User No. ".concat(r.from," joined this room"))}break;case"sending_offer":if(r.to===o){console.log("offer_received");var s=a.addPeer(o,r.from,r.offer,a.state.stream);a.setState((function(e){var t=e.peersEstablished,n=a.state.usersConnected.find((function(e){return e.user_id===r.from})),o=[].concat(Object(tt.a)(t),[{user_id:r.from,user_full_name:n.user_full_name,peer:s}]),i=a.state.peersEstablished.find((function(e){return e.user_id===r.from}));if(i){var c=a.state.peersEstablished.filter((function(e){return i.user_id!==e.user_id}));o=[].concat(Object(tt.a)(c),[{user_id:r.from,user_full_name:n.user_full_name,peer:s}])}return{peersEstablished:o}}))}break;case"sending_answer":if(r.to===o)console.log("answer_received"),a.state.peersEstablished.find((function(e){return e.user_id===r.from})).peer.signal(r.answer);break;case"disconnected":if(r.from!==o){var i=a.state.usersConnected.find((function(e){return e.user_id===r.from}));if(i){console.log("User No. ".concat(r.from," disconnected")),t({type:"error",feedbackMsg:"".concat(i.user_full_name," left")});var c=a.state.peersEstablished.find((function(e){return e.user_id===r.from}));if(c){c.peer.destroy();var l=a.state.peersEstablished.filter((function(e){return c.user_id!==e.user_id}));a.setState({peersEstablished:l})}}}}}},a.componentWillUnmount=function(){var e=a.state,t=e.websocket,r=e.peersEstablished,n=e.stream;t&&a.state.websocket.close(),r.forEach((function(e){e.peer.destroy()})),n&&n.getTracks().forEach((function(e){e.stop()})),a.setState({websocket:null,stream:null,usersConnected:[],peersEstablished:[],isVideoMuted:!0,isAudioMuted:!0})},a.state={websocket:null,stream:null,usersConnected:[],peersEstablished:[],isVideoMuted:!1,isAudioMuted:!1,contentLoading:!0,isVideoRoomAccessible:!0},a}return Object(c.a)(r,[{key:"render",value:function(){var e=this.state,t=e.isVideoRoomAccessible,r=e.isVideoMuted,a=e.isAudioMuted,n=e.peersEstablished,o=this.context.userFullName,s=this.props.classes;return Object(N.jsx)("div",{children:t?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:s.floatingButtons,children:[Object(N.jsx)(Ke.a,{title:"Video ON/OFF",children:Object(N.jsx)(nt.a,{className:s.floatingButton,onClick:this.muteVideo,color:"inherit",children:r?Object(N.jsx)(mt.a,{}):Object(N.jsx)(dt.a,{})})}),Object(N.jsx)(Ke.a,{title:"Audio ON/OFF",children:Object(N.jsx)(nt.a,{className:s.floatingButton,onClick:this.muteAudio,color:"inherit",children:a?Object(N.jsx)(ct.a,{}):Object(N.jsx)(st.a,{})})}),Object(N.jsx)(Ke.a,{title:"Leave Room",children:Object(N.jsx)(nt.a,{onClick:this.leaveRoom,className:s.floatingButton,color:"secondary",children:Object(N.jsx)(pt.a,{})})})]}),Object(N.jsx)(ft,{isLocalUser:!0,id:"localVideo",user_full_name:o}),Object(N.jsx)("div",{className:s.videoGrid,children:n.length>0?n.map((function(e,t){return Object(N.jsx)(ft,{id:"remote-".concat(e.user_id),user_id:e.user_id,user_full_name:e.user_full_name,peer:e.peer},t)})):Object(N.jsx)(U.a,{severity:"info",children:"No one joined yet!!"})})]}):Object(N.jsx)(U.a,{className:s.alert,severity:"error",children:"This room is not accessible. Please make sure you enabled your media devices"})})}}]),r}(a.Component);gt.contextType=te;var Ot=Object(D.a)(ht)(gt),vt=["userData","printFeedback"];var xt=function(e){var t=e.userData,r=e.printFeedback,a=Object(O.a)(e,vt),n=t.isUserLoggedIn,o=t.isDataArrived;return Object(N.jsx)(f.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return o&&!n?Object(N.jsx)(f.a,{to:k,exact:!0}):o&&n?Object(N.jsx)(Ot,Object(u.a)({userData:t,printFeedback:r},e)):Object(N.jsx)(Z,{})}}))},kt=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).loadRooms=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.setState({loadingRooms:!0}),ce(ie,e).then((function(e){var t=localStorage.getItem("access_token");ie.defaults.headers.Authorization="Bearer "+t,a.setState((function(){return{roomListData:e.data,loadingRooms:!1}}))})).catch((function(e){a.setState((function(){return{loadingRooms:!1}})),a.printFeedback({type:"error",feedbackMsg:e.message}),console.log(e.message)}))},a.handleSearchChanges=function(){var e=Object(m.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({search:t.target.value});case 2:return e.next=4,a.loadRooms(a.state.search);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.printFeedback=function(e){var t=e.type,r=e.feedbackMsg;switch(t){case"success":a.setState({severity:"success",feedbackMsg:r,isFeedbackOpen:!0});break;case"error":a.setState({severity:"error",feedbackMsg:r,isFeedbackOpen:!0})}},a.closeFeedback=function(e,t){"clickaway"!==t&&a.setState({isFeedbackOpen:!1})},a.authenticateUser=function(){var e=localStorage.getItem("refresh_token");le(ie,e).then((function(t){if(200===t.status){var r=Object(g.a)(e).user_id,n=Object(g.a)(e).full_name;a.setState({userData:{isDataArrived:!0,userId:r,userFullName:n,isUserLoggedIn:!0}}),de()}})).catch((function(e){console.log(e.message),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),a.setState({userData:{isDataArrived:!0,userId:null,userFullName:"",isUserLoggedIn:!1}})}))},a.componentDidMount=function(){a.authenticateUser()},a.state={userData:{isDataArrived:!1,userId:null,userFullName:"",isUserLoggedIn:!1},isRoomFormOpen:!1,severity:"",feedbackMsg:"",isFeedbackOpen:!1,roomListData:[],loadingRooms:!0,search:""},a.loadRooms=a.loadRooms.bind(Object(b.a)(a)),a.handleSearchChanges=a.handleSearchChanges.bind(Object(b.a)(a)),a.closeRoomForm=a.closeRoomForm.bind(Object(b.a)(a)),a.openRoomForm=a.openRoomForm.bind(Object(b.a)(a)),a.printFeedback=a.printFeedback.bind(Object(b.a)(a)),a.closeFeedback=a.closeFeedback.bind(Object(b.a)(a)),a.authenticateUser=a.authenticateUser.bind(Object(b.a)(a)),a}return Object(c.a)(r,[{key:"closeRoomForm",value:function(){this.setState({isRoomFormOpen:!1})}},{key:"openRoomForm",value:function(){this.setState({isRoomFormOpen:!0})}},{key:"render",value:function(){var e=x,t=k,r=y,a=R,n=this.state,o=n.userData,s=n.isRoomFormOpen,i=n.roomListData,c=n.loadingRooms,l=n.search,d=n.severity,m=n.feedbackMsg,b=n.isFeedbackOpen,p={isUserLoggedIn:o.isUserLoggedIn,printFeedback:this.printFeedback,authenticateUser:this.authenticateUser},h={userData:o,loadingRooms:c,roomListData:i,loadRooms:this.loadRooms,printFeedback:this.printFeedback,closeRoomForm:this.closeRoomForm,isRoomFormOpen:s},g={search:l,handleSearchChanges:this.handleSearchChanges,authenticateUser:this.authenticateUser,openRoomForm:this.openRoomForm,printFeedback:this.printFeedback};return o.isDataArrived?Object(N.jsx)(re,{userData:o,children:Object(N.jsxs)(j.a,{basename:"/app",children:[Object(N.jsx)(et,Object(u.a)({},g)),Object(N.jsx)(P,{closeFeedback:this.closeFeedback,isFeedbackOpen:b,severity:d,feedbackMsg:m}),Object(N.jsxs)(f.d,{children:[Object(N.jsx)(Le,{exact:!0,path:e,lobbyProps:h}),Object(N.jsx)(I,{exact:!0,path:t,component:ge,authenticationProps:p}),Object(N.jsx)(I,{exact:!0,path:r,component:xe,authenticationProps:p}),Object(N.jsx)(xt,{exact:!0,path:a,userData:o,printFeedback:this.printFeedback})]})]})}):Object(N.jsx)(Z,{})}}]),r}(a.Component),yt=kt,Rt=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(c.a)(r,[{key:"render",value:function(){return Object(N.jsx)(Q.a,{children:Object(N.jsx)(yt,{})})}}]),r}(n.a.Component),wt=Rt;s.a.render(Object(N.jsx)(n.a.StrictMode,{children:Object(N.jsx)(wt,{})}),document.getElementById("root"))}},[[261,1,2]]]);
//# sourceMappingURL=main.9447cd7f.chunk.js.map